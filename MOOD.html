<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Connection Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Caveat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0f4f8;
        }
        .handwritten {
            font-family: 'Caveat', cursive;
        }
        .card {
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .mood-option {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .mood-option:hover {
            transform: scale(1.05);
        }
        .mood-option.selected {
            border-width: 2px;
            transform: scale(1.05);
        }
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .color-option:hover {
            transform: scale(1.1);
        }
        .color-option.selected {
            border: 2px solid #333;
            transform: scale(1.1);
        }
        .mood-display {
            display: flex;
            align-items: flex-start;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .mood-message {
            font-family: 'Caveat', cursive;
            font-size: 1.1rem;
            line-height: 1.3;
            margin-top: 0.25rem;
        }
    </style>
</head>
<body>
    <div class="min-h-screen flex flex-col p-4">
        <div class="container mx-auto max-w-6xl">
            <!-- Today's Connection with Moods -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden card mb-6">
                <div class="bg-gradient-to-r from-pink-500 to-purple-500 p-4 text-white flex justify-between items-center">
                    <div>
                        <h2 class="text-xl font-bold mb-2">Mood Connection</h2>
                        <p class="text-sm opacity-80">Share your feelings with personal messages</p>
                    </div>
                    <div>
                        <button id="settingsBtn" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-3 py-2 rounded-lg flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            Settings
                        </button>
                    </div>
                </div>
                <div class="p-4">
                    <!-- Two-column layout for side-by-side mood sections -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                        <!-- Left Column: Your Mood -->
                        <div class="border rounded-lg p-3">
                            <h3 class="font-medium text-gray-700 mb-3"><span id="yourNameMood">Your</span> Mood</h3>
                            
                            <!-- Your Mood Selection -->
                            <div class="grid grid-cols-4 sm:grid-cols-4 md:grid-cols-4 lg:grid-cols-4 gap-2 mb-3">
                                <!-- Organized from most positive to most negative -->
                                <div class="mood-option your-mood p-2 text-center rounded-lg border border-transparent" data-mood="excited" data-emoji="ü§©" data-text="Excited">
                                    <div class="text-3xl">ü§©</div>
                                    <div class="text-xs text-gray-500">Excited</div>
                                </div>
                                <div class="mood-option your-mood p-2 text-center rounded-lg border border-transparent" data-mood="loved" data-emoji="üòç" data-text="Feeling Loved">
                                    <div class="text-3xl">üòç</div>
                                    <div class="text-xs text-gray-500">Loved</div>
                                </div>
                                <div class="mood-option your-mood p-2 text-center rounded-lg border border-transparent" data-mood="happy" data-emoji="üòä" data-text="Happy">
                                    <div class="text-3xl">üòä</div>
                                    <div class="text-xs text-gray-500">Happy</div>
                                </div>
                                <div class="mood-option your-mood p-2 text-center rounded-lg border border-transparent" data-mood="meh" data-emoji="üòê" data-text="Meh">
                                    <div class="text-3xl">üòê</div>
                                    <div class="text-xs text-gray-500">Meh</div>
                                </div>
                                <div class="mood-option your-mood p-2 text-center rounded-lg border border-transparent" data-mood="tired" data-emoji="üò¥" data-text="Tired">
                                    <div class="text-3xl">üò¥</div>
                                    <div class="text-xs text-gray-500">Tired</div>
                                </div>
                                <div class="mood-option your-mood p-2 text-center rounded-lg border border-transparent" data-mood="miss" data-emoji="üíî" data-text="Missing You">
                                    <div class="text-3xl">üíî</div>
                                    <div class="text-xs text-gray-500">Miss</div>
                                </div>
                                <div class="mood-option your-mood p-2 text-center rounded-lg border border-transparent" data-mood="sad" data-emoji="üò¢" data-text="Sad">
                                    <div class="text-3xl">üò¢</div>
                                    <div class="text-xs text-gray-500">Sad</div>
                                </div>
                                <div class="mood-option your-mood p-2 text-center rounded-lg border border-transparent" data-mood="angry" data-emoji="üò°" data-text="Angry">
                                    <div class="text-3xl">üò°</div>
                                    <div class="text-xs text-gray-500">Angry</div>
                                </div>
                            </div>
                            
                            <!-- Your Mood Message Input -->
                            <div class="flex mb-4">
                                <input type="text" id="yourMoodMessageInput" class="border rounded-l px-3 py-2 w-full" placeholder="Add a message with your mood...">
                                <button id="updateYourMood" class="bg-indigo-500 text-white px-4 py-2 rounded-r hover:bg-indigo-600">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                </button>
                            </div>
                            
                            <!-- Your Current Mood Display -->
                            <div id="yourCurrentMood">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-medium text-indigo-600">Current <span id="yourNameMoodDisplay">Your</span> Mood:</span>
                                    <span id="yourMoodTimestampDisplay" class="text-xs text-gray-500">Not set yet</span>
                                </div>
                                <div class="mood-display bg-indigo-50 border border-indigo-100">
                                    <div id="yourMoodEmoji" class="text-3xl mr-3">‚ùì</div>
                                    <div class="flex-1">
                                        <div id="yourMoodText" class="font-medium">No mood selected</div>
                                        <div id="yourMoodMessage" class="mood-message text-gray-700">Select a mood above and add a message</div>
                                        <div id="yourMoodTimestamp" class="text-xs text-gray-500 mt-1">Select a mood above</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Right Column: Partner's Mood -->
                        <div class="border rounded-lg p-3">
                            <h3 class="font-medium text-gray-700 mb-3"><span id="partnerNameMood">Partner's</span> Mood</h3>
                            
                            <!-- Partner's Mood Selection -->
                            <div class="grid grid-cols-4 sm:grid-cols-4 md:grid-cols-4 lg:grid-cols-4 gap-2 mb-3">
                                <!-- Organized from most positive to most negative -->
                                <div class="mood-option partner-mood p-2 text-center rounded-lg border border-transparent" data-mood="excited" data-emoji="ü§©" data-text="Excited">
                                    <div class="text-3xl">ü§©</div>
                                    <div class="text-xs text-gray-500">Excited</div>
                                </div>
                                <div class="mood-option partner-mood p-2 text-center rounded-lg border border-transparent" data-mood="loved" data-emoji="üòç" data-text="Feeling Loved">
                                    <div class="text-3xl">üòç</div>
                                    <div class="text-xs text-gray-500">Loved</div>
                                </div>
                                <div class="mood-option partner-mood p-2 text-center rounded-lg border border-transparent" data-mood="happy" data-emoji="üòä" data-text="Happy">
                                    <div class="text-3xl">üòä</div>
                                    <div class="text-xs text-gray-500">Happy</div>
                                </div>
                                <div class="mood-option partner-mood p-2 text-center rounded-lg border border-transparent" data-mood="meh" data-emoji="üòê" data-text="Meh">
                                    <div class="text-3xl">üòê</div>
                                    <div class="text-xs text-gray-500">Meh</div>
                                </div>
                                <div class="mood-option partner-mood p-2 text-center rounded-lg border border-transparent" data-mood="tired" data-emoji="üò¥" data-text="Tired">
                                    <div class="text-3xl">üò¥</div>
                                    <div class="text-xs text-gray-500">Tired</div>
                                </div>
                                <div class="mood-option partner-mood p-2 text-center rounded-lg border border-transparent" data-mood="miss" data-emoji="üíî" data-text="Missing You">
                                    <div class="text-3xl">üíî</div>
                                    <div class="text-xs text-gray-500">Miss</div>
                                </div>
                                <div class="mood-option partner-mood p-2 text-center rounded-lg border border-transparent" data-mood="sad" data-emoji="üò¢" data-text="Sad">
                                    <div class="text-3xl">üò¢</div>
                                    <div class="text-xs text-gray-500">Sad</div>
                                </div>
                                <div class="mood-option partner-mood p-2 text-center rounded-lg border border-transparent" data-mood="angry" data-emoji="üò°" data-text="Angry">
                                    <div class="text-3xl">üò°</div>
                                    <div class="text-xs text-gray-500">Angry</div>
                                </div>
                            </div>
                            
                            <!-- Partner's Mood Message Input -->
                            <div class="flex mb-4">
                                <input type="text" id="partnerMoodMessageInput" class="border rounded-l px-3 py-2 w-full" placeholder="Add a message with their mood...">
                                <button id="updatePartnerMood" class="bg-pink-500 text-white px-4 py-2 rounded-r hover:bg-pink-600">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                </button>
                            </div>
                            
                            <!-- Partner's Current Mood Display -->
                            <div id="partnerCurrentMood">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-medium text-pink-600">Current <span id="partnerNameMoodDisplay">Partner's</span> Mood:</span>
                                    <span id="partnerMoodTimestampDisplay" class="text-xs text-gray-500">Not set yet</span>
                                </div>
                                <div class="mood-display bg-pink-50 border border-pink-100">
                                    <div id="partnerMoodEmoji" class="text-3xl mr-3">‚ùì</div>
                                    <div class="flex-1">
                                        <div id="partnerMoodText" class="font-medium">No mood selected</div>
                                        <div id="partnerMoodMessage" class="mood-message text-gray-700">Select a mood above and add a message</div>
                                        <div id="partnerMoodTimestamp" class="text-xs text-gray-500 mt-1">Select a mood above</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">Settings</h2>
                <button id="closeSettings" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="space-y-6">
                <div>
                    <label class="block text-gray-700 mb-2" for="yourName">Your Name</label>
                    <input type="text" id="yourName" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="Enter your name">
                </div>
                
                <div>
                    <label class="block text-gray-700 mb-2">Your Color Theme</label>
                    <div class="flex flex-wrap gap-2" id="yourColorOptions">
                        <div class="color-option your-color" data-color="indigo" style="background-color: #4F46E5;"></div>
                        <div class="color-option your-color" data-color="blue" style="background-color: #2563EB;"></div>
                        <div class="color-option your-color" data-color="purple" style="background-color: #7C3AED;"></div>
                        <div class="color-option your-color" data-color="green" style="background-color: #10B981;"></div>
                        <div class="color-option your-color" data-color="red" style="background-color: #EF4444;"></div>
                        <div class="color-option your-color" data-color="amber" style="background-color: #F59E0B;"></div>
                    </div>
                </div>
                
                <div>
                    <label class="block text-gray-700 mb-2" for="partnerName">Partner's Name</label>
                    <input type="text" id="partnerName" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="Enter partner's name">
                </div>
                
                <div>
                    <label class="block text-gray-700 mb-2">Partner's Color Theme</label>
                    <div class="flex flex-wrap gap-2" id="partnerColorOptions">
                        <div class="color-option partner-color" data-color="pink" style="background-color: #EC4899;"></div>
                        <div class="color-option partner-color" data-color="rose" style="background-color: #F43F5E;"></div>
                        <div class="color-option partner-color" data-color="orange" style="background-color: #F97316;"></div>
                        <div class="color-option partner-color" data-color="teal" style="background-color: #14B8A6;"></div>
                        <div class="color-option partner-color" data-color="cyan" style="background-color: #06B6D4;"></div>
                        <div class="color-option partner-color" data-color="violet" style="background-color: #8B5CF6;"></div>
                    </div>
                </div>
                
                <div class="flex justify-end">
                    <button id="saveSettings" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">Save Settings</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let selectedYourMood = null;
        let selectedPartnerMood = null;
        
        // Color mappings
        const colorMappings = {
            // Your color options
            indigo: {
                light: 'bg-indigo-50',
                medium: 'bg-indigo-100',
                dark: 'bg-indigo-600',
                text: 'text-indigo-700',
                border: 'border-indigo-300',
                borderAccent: 'border-indigo-400',
                hover: 'hover:bg-indigo-100'
            },
            blue: {
                light: 'bg-blue-50',
                medium: 'bg-blue-100',
                dark: 'bg-blue-600',
                text: 'text-blue-700',
                border: 'border-blue-300',
                borderAccent: 'border-blue-400',
                hover: 'hover:bg-blue-100'
            },
            purple: {
                light: 'bg-purple-50',
                medium: 'bg-purple-100',
                dark: 'bg-purple-600',
                text: 'text-purple-700',
                border: 'border-purple-300',
                borderAccent: 'border-purple-400',
                hover: 'hover:bg-purple-100'
            },
            green: {
                light: 'bg-green-50',
                medium: 'bg-green-100',
                dark: 'bg-green-600',
                text: 'text-green-700',
                border: 'border-green-300',
                borderAccent: 'border-green-400',
                hover: 'hover:bg-green-100'
            },
            red: {
                light: 'bg-red-50',
                medium: 'bg-red-100',
                dark: 'bg-red-600',
                text: 'text-red-700',
                border: 'border-red-300',
                borderAccent: 'border-red-400',
                hover: 'hover:bg-red-100'
            },
            amber: {
                light: 'bg-amber-50',
                medium: 'bg-amber-100',
                dark: 'bg-amber-600',
                text: 'text-amber-700',
                border: 'border-amber-300',
                borderAccent: 'border-amber-400',
                hover: 'hover:bg-amber-100'
            },
            
            // Partner color options
            pink: {
                light: 'bg-pink-50',
                medium: 'bg-pink-100',
                dark: 'bg-pink-600',
                text: 'text-pink-700',
                border: 'border-pink-300',
                borderAccent: 'border-pink-400',
                hover: 'hover:bg-pink-100'
            },
            rose: {
                light: 'bg-rose-50',
                medium: 'bg-rose-100',
                dark: 'bg-rose-600',
                text: 'text-rose-700',
                border: 'border-rose-300',
                borderAccent: 'border-rose-400',
                hover: 'hover:bg-rose-100'
            },
            orange: {
                light: 'bg-orange-50',
                medium: 'bg-orange-100',
                dark: 'bg-orange-600',
                text: 'text-orange-700',
                border: 'border-orange-300',
                borderAccent: 'border-orange-400',
                hover: 'hover:bg-orange-100'
            },
            teal: {
                light: 'bg-teal-50',
                medium: 'bg-teal-100',
                dark: 'bg-teal-600',
                text: 'text-teal-700',
                border: 'border-teal-300',
                borderAccent: 'border-teal-400',
                hover: 'hover:bg-teal-100'
            },
            cyan: {
                light: 'bg-cyan-50',
                medium: 'bg-cyan-100',
                dark: 'bg-cyan-600',
                text: 'text-cyan-700',
                border: 'border-cyan-300',
                borderAccent: 'border-cyan-400',
                hover: 'hover:bg-cyan-100'
            },
            violet: {
                light: 'bg-violet-50',
                medium: 'bg-violet-100',
                dark: 'bg-violet-600',
                text: 'text-violet-700',
                border: 'border-violet-300',
                borderAccent: 'border-violet-400',
                hover: 'hover:bg-violet-100'
            }
        };

        // Function to format date and time
        function formatDateTime(timestamp) {
            if (!timestamp) return "Not set yet";
            
            const date = new Date(timestamp);
            const today = new Date();
            
            // Check if it's today
            if (date.toDateString() === today.toDateString()) {
                return `Today, ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;
            } else {
                return `${date.toLocaleDateString()}, ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;
            }
        }

        // Function to update mood display
        function updateMoodDisplay(type, data) {
            if (!data) return;
            
            const settings = getSettings();
            const yourColor = settings.yourColor || 'indigo';
            const partnerColor = settings.partnerColor || 'pink';
            
            if (type === 'your') {
                document.getElementById('yourMoodEmoji').textContent = data.emoji;
                document.getElementById('yourMoodText').textContent = data.text;
                document.getElementById('yourMoodMessage').textContent = data.message || "No message added";
                document.getElementById('yourMoodTimestamp').textContent = formatDateTime(data.timestamp);
                document.getElementById('yourMoodTimestampDisplay').textContent = formatDateTime(data.timestamp);
                
                // Update color theme
                const yourMoodDisplay = document.querySelector('#yourCurrentMood .mood-display');
                // Remove all potential color classes
                Object.keys(colorMappings).forEach(color => {
                    yourMoodDisplay.classList.remove(
                        `bg-${color}-50`,
                        `border-${color}-100`
                    );
                });
                // Add current color
                yourMoodDisplay.classList.add(
                    `bg-${yourColor}-50`,
                    `border-${yourColor}-100`
                );
            } else {
                document.getElementById('partnerMoodEmoji').textContent = data.emoji;
                document.getElementById('partnerMoodText').textContent = data.text;
                document.getElementById('partnerMoodMessage').textContent = data.message || "No message added";
                document.getElementById('partnerMoodTimestamp').textContent = formatDateTime(data.timestamp);
                document.getElementById('partnerMoodTimestampDisplay').textContent = formatDateTime(data.timestamp);
                
                // Update color theme
                const partnerMoodDisplay = document.querySelector('#partnerCurrentMood .mood-display');
                // Remove all potential color classes
                Object.keys(colorMappings).forEach(color => {
                    partnerMoodDisplay.classList.remove(
                        `bg-${color}-50`,
                        `border-${color}-100`
                    );
                });
                // Add current color
                partnerMoodDisplay.classList.add(
                    `bg-${partnerColor}-50`,
                    `border-${partnerColor}-100`
                );
            }
        }

        // Function to load moods from localStorage
        function loadMoods() {
            try {
                // Load your mood
                const yourMoodData = localStorage.getItem('yourMoodData');
                if (yourMoodData) {
                    const data = JSON.parse(yourMoodData);
                    document.querySelectorAll('.your-mood').forEach(mood => {
                        if (mood.dataset.mood === data.mood) {
                            selectMood(mood, 'your');
                        }
                    });
                    updateMoodDisplay('your', data);
                }
                
                // Load partner mood
                const partnerMoodData = localStorage.getItem('partnerMoodData');
                if (partnerMoodData) {
                    const data = JSON.parse(partnerMoodData);
                    document.querySelectorAll('.partner-mood').forEach(mood => {
                        if (mood.dataset.mood === data.mood) {
                            selectMood(mood, 'partner');
                        }
                    });
                    updateMoodDisplay('partner', data);
                }
            } catch (e) {
                console.error("Error loading moods:", e);
            }
        }

        // Function to select a mood
        function selectMood(moodElement, type) {
            // Get settings for colors
            const settings = getSettings();
            const yourColor = settings.yourColor || 'indigo';
            const partnerColor = settings.partnerColor || 'pink';
            
            // Remove selected class from all moods of this type
            document.querySelectorAll(`.${type}-mood`).forEach(mood => {
                mood.classList.remove('selected');
                mood.classList.remove(`border-${yourColor}-500`, `border-${partnerColor}-500`);
            });
            
            // Add selected class to clicked mood
            moodElement.classList.add('selected');
            
            // Store the selected mood
            if (type === 'your') {
                selectedYourMood = {
                    mood: moodElement.dataset.mood,
                    emoji: moodElement.dataset.emoji,
                    text: moodElement.dataset.text
                };
                moodElement.classList.add(`border-${yourColor}-500`);
            } else {
                selectedPartnerMood = {
                    mood: moodElement.dataset.mood,
                    emoji: moodElement.dataset.emoji,
                    text: moodElement.dataset.text
                };
                moodElement.classList.add(`border-${partnerColor}-500`);
            }
        }

        // Function to update mood with message
        function updateMoodWithMessage(type) {
            // Current timestamp
            const now = new Date();
            const { yourName, partnerName } = getNames();
            
            if (type === 'your') {
                if (!selectedYourMood) {
                    alert('Please select a mood first');
                    return;
                }
                
                const message = document.getElementById('yourMoodMessageInput').value.trim();
                
                // Save mood, message and timestamp
                const moodData = {
                    ...selectedYourMood,
                    message: message,
                    timestamp: now.getTime(),
                    person: yourName,
                    type: 'your'
                };
                
                localStorage.setItem('yourMoodData', JSON.stringify(moodData));
                updateMoodDisplay('your', moodData);
                
                // Clear input
                document.getElementById('yourMoodMessageInput').value = '';
                
            } else {
                if (!selectedPartnerMood) {
                    alert('Please select a mood first');
                    return;
                }
                
                const message = document.getElementById('partnerMoodMessageInput').value.trim();
                
                // Save mood, message and timestamp
                const moodData = {
                    ...selectedPartnerMood,
                    message: message,
                    timestamp: now.getTime(),
                    person: partnerName,
                    type: 'partner'
                };
                
                localStorage.setItem('partnerMoodData', JSON.stringify(moodData));
                updateMoodDisplay('partner', moodData);
                
                // Clear input
                document.getElementById('partnerMoodMessageInput').value = '';
            }
        }

        // Function to get settings
        function getSettings() {
            return JSON.parse(localStorage.getItem('moodConnectionSettings') || '{}');
        }

        // Function to get names from settings
        function getNames() {
            const settings = getSettings();
            return {
                yourName: settings.yourName || 'You',
                partnerName: settings.partnerName || 'Partner'
            };
        }

        // Function to update name displays throughout the app
        function updateNameDisplays() {
            const { yourName, partnerName } = getNames();
            
            // Update mood section headers
            document.getElementById('yourNameMood').textContent = yourName + "'s";
            document.getElementById('partnerNameMood').textContent = partnerName + "'s";
            
            // Update current mood displays
            document.getElementById('yourNameMoodDisplay').textContent = yourName + "'s";
            document.getElementById('partnerNameMoodDisplay').textContent = partnerName + "'s";
            
            // Update mood message input placeholders
            document.getElementById('yourMoodMessageInput').placeholder = `Add a message with ${yourName}'s mood...`;
            document.getElementById('partnerMoodMessageInput').placeholder = `Add a message with ${partnerName}'s mood...`;
        }
        
        // Function to update color themes throughout the app
        function updateColorThemes() {
            const settings = getSettings();
            const yourColor = settings.yourColor || 'indigo';
            const partnerColor = settings.partnerColor || 'pink';
            
            // Update mood update buttons
            document.getElementById('updateYourMood').className = `bg-${yourColor}-500 text-white px-4 py-2 rounded-r hover:bg-${yourColor}-600`;
            document.getElementById('updatePartnerMood').className = `bg-${partnerColor}-500 text-white px-4 py-2 rounded-r hover:bg-${partnerColor}-600`;
            
            // Update mood selections with new colors
            updateMoodSelectionColors();
            
            // Update current mood displays
            const yourMoodDisplay = document.querySelector('#yourCurrentMood .mood-display');
            const partnerMoodDisplay = document.querySelector('#partnerCurrentMood .mood-display');
            
            // Remove all potential color classes
            Object.keys(colorMappings).forEach(color => {
                yourMoodDisplay.classList.remove(
                    `bg-${color}-50`,
                    `border-${color}-100`
                );
                partnerMoodDisplay.classList.remove(
                    `bg-${color}-50`,
                    `border-${color}-100`
                );
            });
            
            // Add current colors
            yourMoodDisplay.classList.add(
                `bg-${yourColor}-50`,
                `border-${yourColor}-100`
            );
            partnerMoodDisplay.classList.add(
                `bg-${partnerColor}-50`,
                `border-${partnerColor}-100`
            );
            
            // Update name colors
            document.querySelector('#yourCurrentMood .text-sm').className = `text-sm font-medium text-${yourColor}-600`;
            document.querySelector('#partnerCurrentMood .text-sm').className = `text-sm font-medium text-${partnerColor}-600`;
        }
        
        // Function to update mood selection colors
        function updateMoodSelectionColors() {
            const settings = getSettings();
            const yourColor = settings.yourColor || 'indigo';
            const partnerColor = settings.partnerColor || 'pink';
            
            // Update your mood selection
            document.querySelectorAll('.your-mood.selected').forEach(mood => {
                // Remove all potential border colors
                Object.keys(colorMappings).forEach(color => {
                    mood.classList.remove(`border-${color}-500`);
                });
                // Add current color
                mood.classList.add(`border-${yourColor}-500`);
            });
            
            // Update partner mood selection
            document.querySelectorAll('.partner-mood.selected').forEach(mood => {
                // Remove all potential border colors
                Object.keys(colorMappings).forEach(color => {
                    mood.classList.remove(`border-${color}-500`);
                });
                // Add current color
                mood.classList.add(`border-${partnerColor}-500`);
            });
        }

        // Function to handle color selection
        function handleColorSelection(colorOptions) {
            colorOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove selected class from all options
                    colorOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Add selected class to clicked option
                    this.classList.add('selected');
                });
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Initialize settings if not already set
            if (!localStorage.getItem('moodConnectionSettings')) {
                localStorage.setItem('moodConnectionSettings', JSON.stringify({
                    yourName: 'You',
                    partnerName: 'Partner',
                    yourColor: 'indigo',
                    partnerColor: 'pink'
                }));
            }
            
            // Setup color selection in settings modal
            const yourColorOptions = document.querySelectorAll('.your-color');
            const partnerColorOptions = document.querySelectorAll('.partner-color');
            
            handleColorSelection(yourColorOptions);
            handleColorSelection(partnerColorOptions);
            
            // Load moods
            loadMoods();
            updateNameDisplays();
            updateColorThemes();
            
            // Setup mood selection
            document.querySelectorAll('.your-mood').forEach(mood => {
                mood.addEventListener('click', function() {
                    selectMood(this, 'your');
                });
            });
            
            document.querySelectorAll('.partner-mood').forEach(mood => {
                mood.addEventListener('click', function() {
                    selectMood(this, 'partner');
                });
            });
            
            // Setup mood update buttons
            document.getElementById('updateYourMood').addEventListener('click', function() {
                updateMoodWithMessage('your');
            });
            
            document.getElementById('updatePartnerMood').addEventListener('click', function() {
                updateMoodWithMessage('partner');
            });
            
            // Add mood message on Enter key
            document.getElementById('yourMoodMessageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    updateMoodWithMessage('your');
                }
            });
            
            document.getElementById('partnerMoodMessageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    updateMoodWithMessage('partner');
                }
            });
            
            // Settings Modal
            const settingsBtn = document.getElementById('settingsBtn');
            const settingsModal = document.getElementById('settingsModal');
            const closeSettings = document.getElementById('closeSettings');
            const saveSettings = document.getElementById('saveSettings');

            settingsBtn.addEventListener('click', function() {
                // Load current settings into form
                const settings = getSettings();
                document.getElementById('yourName').value = settings.yourName || '';
                document.getElementById('partnerName').value = settings.partnerName || '';
                
                // Set selected color options
                const yourColor = settings.yourColor || 'indigo';
                const partnerColor = settings.partnerColor || 'pink';
                
                document.querySelectorAll('.your-color').forEach(opt => {
                    opt.classList.remove('selected');
                    if (opt.dataset.color === yourColor) {
                        opt.classList.add('selected');
                    }
                });
                
                document.querySelectorAll('.partner-color').forEach(opt => {
                    opt.classList.remove('selected');
                    if (opt.dataset.color === partnerColor) {
                        opt.classList.add('selected');
                    }
                });
                
                settingsModal.classList.remove('hidden');
            });

            closeSettings.addEventListener('click', function() {
                settingsModal.classList.add('hidden');
            });

            saveSettings.addEventListener('click', function() {
                // Get selected colors
                const yourColorElement = document.querySelector('.your-color.selected');
                const partnerColorElement = document.querySelector('.partner-color.selected');
                
                const yourColor = yourColorElement ? yourColorElement.dataset.color : 'indigo';
                const partnerColor = partnerColorElement ? partnerColorElement.dataset.color : 'pink';
                
                // Save settings logic
                const yourName = document.getElementById('yourName').value || 'You';
                const partnerName = document.getElementById('partnerName').value || 'Partner';
                
                // Save to localStorage
                localStorage.setItem('moodConnectionSettings', JSON.stringify({
                    yourName,
                    partnerName,
                    yourColor,
                    partnerColor
                }));
                
                // Update UI with names and colors
                updateNameDisplays();
                updateColorThemes();
                
                // Close modal
                settingsModal.classList.add('hidden');
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98353ae260d9aac8',t:'MTc1ODU4MDA1MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
